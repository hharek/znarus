<?php
/**
 * Показать все страницы
 * 
 * @param type $page
 * @param type $level
 */
function parent_html($page, $level, $current)
{
?>

<?php foreach ($page as $val): ?>
	
	<option value="<?php echo $val['ID']; ?>"<?php if($val['ID'] == $current): ?> selected="selected"<?php endif; ?>>
		<?php echo str_repeat("&nbsp;", $level * 4) . $val['Name']; ?>
	</option>
	
	<?php parent_html($val['Child'], $level + 1, $current); ?>
	
<?php endforeach; ?>

<?php
}
?>

<form>
	<table class="std_form" align="center">
		<tr>
			<td>Наименование</td>
			<td>
				<input type="text" name="Name" id="Name"/>
			</td>
		</tr>
		<tr>
			<td>Адрес</td>
			<td>
				<input type="text" name="Url" id="Url"/>
			</td>
		</tr>
		<tr>
			<td colspan="2">
				<textarea name="Content"></textarea>
			</td>
		</tr>
		<tr>
			<td>Теги</td>
			<td>
				<textarea name="Tags"></textarea>
			</td>
		</tr>
		<tr>
			<td>Другое</td>
			<td>
				<input type="checkbox" id="show_other"/>
			</td>
		</tr>
		<tr id="tr_parent" style="display:none;">
			<td>Корень</td>
			<td>
				<select name="Parent">
					<option value="0"></option>
					<?php parent_html($page_all, 0, $parent); ?>
				</select>
			</td>
		</tr>
		<tr id="tr_html" style="display:none;">
			<td>Шаблон</td>
			<td>
				<select name="Html_ID">
					<option value=""></option>
					<?php foreach ($html as $val): ?>
						<option value="<?php echo $val['ID']; ?>">
							<?php echo $val['Name']; ?>
						</option>
					<?php endforeach; ?>
				</select>
			</td>
		</tr>
	</table>
	<div class="center">
		<div class="std_button submit">
			<div class="icon_add"></div>
			Добавить
		</div>
		<a class="std_button" href="#page/list">
			<div class="icon_back"></div>
			Назад
		</a>
	</div>
</form>
	
<script>
/* Отображить другое */
$("#show_other").click(function()
{
	if($(this).is(":checked") === true)
	{
		$("#tr_parent").show();
		$("#tr_html").show();
	}
	else
	{
		$("#tr_parent").hide();
		$("#tr_html").hide();
	}
});

/* Транслит */
$("#Name").change(function()
{
	$("#Url").val(translit_rus($(this).val()));
});

$("#Name").keypress(function()
{
	$("#Url").val(translit_rus($(this).val()));
});
</script>